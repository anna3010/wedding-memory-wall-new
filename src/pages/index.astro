---
import MainLayout from '../layouts/MainLayout.astro';
import MemoryGallery from '../components/MemoryGallery.jsx';
---

<MainLayout title="Wedding Memory Wall - Gallery">
  <div class="min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 relative overflow-hidden">
    <!-- Animated Background Effects -->
    <div class="fixed inset-0 pointer-events-none">
      <!-- Floating Hearts -->
      <div class="absolute top-10 left-10 text-pink-300 animate-float text-2xl opacity-60">ğŸ’•</div>
      <div class="absolute top-20 right-20 text-purple-300 animate-float text-3xl opacity-60" style="animation-delay: 2s">ğŸ’–</div>
      <div class="absolute bottom-20 left-20 text-pink-300 animate-float text-xl opacity-60" style="animation-delay: 4s">ğŸ’—</div>
      <div class="absolute bottom-10 right-10 text-purple-300 animate-float text-2xl opacity-60" style="animation-delay: 6s">ğŸ’</div>
      <div class="absolute top-1/3 left-1/4 text-pink-200 animate-float text-2xl opacity-40" style="animation-delay: 8s">ğŸ’•</div>
      <div class="absolute top-1/2 right-1/4 text-purple-200 animate-float text-3xl opacity-40" style="animation-delay: 10s">ğŸ’–</div>
      
      <!-- Sparkle Effects -->
      <div class="absolute top-1/4 left-1/3 text-yellow-300 animate-sparkle text-lg opacity-80" style="animation-delay: 1s">âœ¨</div>
      <div class="absolute top-3/4 right-1/3 text-yellow-300 animate-sparkle text-lg opacity-80" style="animation-delay: 3s">âœ¨</div>
      <div class="absolute top-1/2 left-1/2 text-yellow-300 animate-sparkle text-lg opacity-80" style="animation-delay: 5s">âœ¨</div>
    </div>

    <!-- Hero Section -->
    <div class="relative overflow-hidden">
      <div class="absolute inset-0 bg-gradient-to-r from-pink-100/50 to-purple-100/50"></div>
      <div class="relative max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-6 sm:py-8 lg:py-12">
        <div class="text-center">
          <!-- Animated Hearts Background - Mobile Optimized -->
          <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <span class="absolute top-5 left-3 text-pink-300 animate-pulse text-lg sm:text-2xl">ğŸ’•</span>
            <span class="absolute top-10 right-3 text-purple-300 animate-pulse text-xl sm:text-3xl" style="animation-delay: 0.5s">ğŸ’–</span>
            <span class="absolute bottom-10 left-3 text-pink-300 animate-pulse text-base sm:text-xl" style="animation-delay: 1s">ğŸ’—</span>
            <span class="absolute bottom-5 right-3 text-purple-300 animate-pulse text-lg sm:text-2xl" style="animation-delay: 1.5s">ğŸ’</span>
            <!-- Additional hearts for larger screens -->
            <span class="hidden sm:block absolute top-1/3 left-1/4 text-pink-200 animate-pulse text-2xl" style="animation-delay: 2s">ğŸ’•</span>
            <span class="hidden sm:block absolute top-1/2 right-1/4 text-purple-200 animate-pulse text-3xl" style="animation-delay: 2.5s">ğŸ’–</span>
          </div>
          
          <!-- Couple Names - Mobile First -->
          <div class="mb-4 sm:mb-6 lg:mb-8 animate-fade-in">
            <h1 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent mb-2 leading-tight">
              Daniel & Husna
            </h1>
            <div class="flex items-center justify-center gap-1 sm:gap-2 text-gray-600 text-sm sm:text-base lg:text-lg">
              <span class="text-pink-500 text-sm sm:text-base">ğŸ’‘</span>
              <span class="whitespace-nowrap">Together Forever</span>
              <span class="text-pink-500 text-sm sm:text-base">ğŸ’‘</span>
            </div>
          </div>
          
          <!-- Wedding Memory Wall Title -->
          <div class="mb-4 sm:mb-6 lg:mb-8 animate-fade-in" style="animation-delay: 0.2s">
            <h2 class="text-xl sm:text-2xl lg:text-3xl xl:text-4xl font-bold text-gray-900 mb-2 sm:mb-3 lg:mb-4">
              Wedding Memory Wall
            </h2>
            <p class="text-sm sm:text-base lg:text-lg xl:text-xl text-gray-600 mb-3 sm:mb-4 lg:mb-6 px-2 sm:px-4 max-w-lg sm:max-w-2xl mx-auto leading-relaxed">
              Share and cherish the beautiful memories from our special day. Every photo, video, and message tells a part of our love story.
            </p>
          </div>
          
          <!-- Hashtag -->
          <div class="mb-6 sm:mb-8 lg:mb-10 animate-fade-in" style="animation-delay: 0.4s">
            <div class="inline-flex items-center px-3 sm:px-4 lg:px-6 py-1.5 sm:py-2 lg:py-3 bg-gradient-to-r from-pink-100 to-purple-100 rounded-full border border-pink-200">
              <span class="text-pink-600 font-semibold text-xs sm:text-sm lg:text-base">#HusnaHeartsDaniel</span>
            </div>
          </div>
          
          <!-- Music Player -->
          <div class="mb-6 sm:mb-8 lg:mb-10 animate-fade-in" style="animation-delay: 0.6s">
            <div class="bg-white/80 backdrop-blur-sm rounded-xl border border-pink-200 p-4 max-w-md mx-auto shadow-sm">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <span class="text-pink-500">ğŸµ</span>
                  <span class="text-sm font-medium text-gray-700">Wedding Music</span>
                </div>
                <div class="flex items-center gap-2">
                  <button id="musicToggle" class="text-pink-500 hover:text-pink-600 transition-colors" title="Play/Pause">
                    <svg id="playIcon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                    </svg>
                    <svg id="pauseIcon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                  </button>
                  <button id="musicStop" class="text-gray-400 hover:text-gray-600 transition-colors" title="Stop">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clip-rule="evenodd"></path>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="text-xs text-gray-600 text-center mb-3">
                <span id="songTitle">Romantic Piano - Bensound</span>
              </div>
              <!-- Progress Bar -->
              <div class="mb-2">
                <div class="flex items-center justify-between text-xs text-gray-500 mb-1">
                  <span id="currentTime">0:00</span>
                  <span id="duration">0:00</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-1.5">
                  <div id="progressBar" class="bg-pink-500 h-1.5 rounded-full transition-all duration-100" style="width: 0%"></div>
                </div>
              </div>
              <!-- Volume Control -->
              <div class="flex items-center gap-2">
                <span class="text-xs text-gray-500">ğŸ”Š</span>
                <input type="range" id="volumeControl" min="0" max="100" value="50" class="flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                <span id="volumeValue" class="text-xs text-gray-500 w-8">50%</span>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4 animate-fade-in" style="animation-delay: 0.8s">
            <a 
              href="/upload" 
              class="inline-flex items-center px-4 sm:px-6 lg:px-8 py-2.5 sm:py-3 lg:py-4 bg-gradient-to-r from-pink-600 to-purple-600 text-white font-semibold rounded-full hover:from-pink-700 hover:to-purple-700 focus:outline-none focus:ring-4 focus:ring-pink-300 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl text-sm sm:text-base lg:text-lg hover:confetti"
            >
              <svg class="w-4 h-4 sm:w-5 sm:h-5 lg:w-6 lg:h-6 mr-1.5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              <span class="whitespace-nowrap">Add Your Memory</span>
            </a>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Memory Gallery Section -->
    <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-6 sm:py-8 lg:py-12">
      <div class="text-center mb-6 sm:mb-8 lg:mb-12">
        <h3 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-3 sm:mb-4">Memories Shared</h3>
        <div class="flex items-center justify-center flex-wrap gap-2 sm:gap-3 text-gray-600 text-xs sm:text-sm">
          <span class="flex items-center gap-1">
            <span class="text-pink-500">ğŸ“¸</span>
            <span>Photos</span>
          </span>
          <span class="hidden sm:inline">â€¢</span>
          <span class="flex items-center gap-1">
            <span class="text-purple-500">ğŸ¥</span>
            <span>Videos</span>
          </span>
          <span class="hidden sm:inline">â€¢</span>
          <span class="flex items-center gap-1">
            <span class="text-pink-500">ğŸ¤</span>
            <span>Messages</span>
          </span>
          <span class="hidden sm:inline">â€¢</span>
          <span class="flex items-center gap-1">
            <span class="text-purple-500">ğŸ’•</span>
            <span>Love</span>
          </span>
        </div>
      </div>
      
      <MemoryGallery client:load />
    </div>
    
    <!-- Footer Section -->
    <div class="mt-12 sm:mt-16 lg:mt-20 bg-gradient-to-r from-pink-100 to-purple-100">
      <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-6 sm:py-8 lg:py-12 text-center">
        <div class="mb-3 sm:mb-4">
          <span class="text-2xl sm:text-3xl lg:text-4xl">ğŸ’•</span>
        </div>
        <h4 class="text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 mb-2 sm:mb-3">Thank You!</h4>
        <p class="text-sm sm:text-base text-gray-600 mb-3 sm:mb-4 px-2 sm:px-0 leading-relaxed">
          For being part of our special day and sharing these precious memories.
        </p>
        <div class="flex items-center justify-center gap-1 sm:gap-2 text-pink-600 font-semibold text-sm sm:text-base">
          <span>ğŸ’–</span>
          <span class="whitespace-nowrap">Daniel & Husna</span>
          <span>ğŸ’–</span>
        </div>
        <div class="mt-3 sm:mt-4">
          <span class="text-pink-600 font-medium text-xs sm:text-sm">#HusnaHeartsDaniel</span>
        </div>
      </div>
    </div>
  </div>

  <style>
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      25% { transform: translateY(-20px) rotate(5deg); }
      75% { transform: translateY(-10px) rotate(-5deg); }
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slide-in {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes confetti {
      0% { transform: translateY(0) rotateZ(0deg); }
      100% { transform: translateY(-100vh) rotateZ(720deg); }
    }
    
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    
    .animate-sparkle {
      animation: sparkle 2s ease-in-out infinite;
    }
    
    .animate-fade-in {
      animation: fade-in 0.8s ease-out forwards;
      opacity: 0;
    }
    
    .animate-slide-in {
      animation: slide-in 0.6s ease-out forwards;
    }
    
    .hover\:confetti:hover {
      position: relative;
      overflow: visible;
    }
    
    .hover\:confetti:hover::after {
      content: 'ğŸŠ';
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      animation: confetti 1s ease-out forwards;
      pointer-events: none;
    }
    
    .theme-btn {
      transition: all 0.3s ease;
    }
    
    .theme-btn:hover {
      transform: scale(1.1);
    }
    
    .theme-btn.active span {
      box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.3);
    }
  </style>

  <script>
    // Wedding Music Player Functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Get DOM elements with null checks
      const playIcon = document.getElementById('playIcon');
      const pauseIcon = document.getElementById('pauseIcon');
      const musicToggle = document.getElementById('musicToggle');
      const musicStop = document.getElementById('musicStop');
      const progressBar = document.getElementById('progressBar');
      const currentTimeEl = document.getElementById('currentTime');
      const durationEl = document.getElementById('duration');
      const volumeControl = document.getElementById('volumeControl') as HTMLInputElement;
      const volumeValue = document.getElementById('volumeValue');
      const songTitle = document.getElementById('songTitle');
      
      // Return if essential elements are missing
      if (!musicToggle || !playIcon || !pauseIcon || !musicStop || !progressBar || 
          !currentTimeEl || !durationEl || !volumeControl || !volumeValue || !songTitle) {
        return;
      }
      
      // Create audio element with romantic wedding music
      const audio = new Audio('https://www.bensound.com/bensound-music/bensound-romantic.mp3');
      audio.loop = true;
      audio.volume = 0.5;
      
      // Wedding playlist
      const playlist = [
        'A Thousand Years - Christina Perri',
        'Perfect - Ed Sheeran', 
        'All of Me - John Legend',
        'Thinking Out Loud - Ed Sheeran',
        'Marry You - Bruno Mars'
      ];
      let currentSongIndex = 0;
      
      // Format time helper
      function formatTime(seconds: number) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      }
      
      // Update progress
      function updateProgress() {
        if (audio.duration && progressBar && currentTimeEl && durationEl) {
          const progressPercent = (audio.currentTime / audio.duration) * 100;
          progressBar.style.width = progressPercent + '%';
          currentTimeEl.textContent = formatTime(audio.currentTime);
          durationEl.textContent = formatTime(audio.duration);
        }
      }
      
      // Play/Pause toggle
      musicToggle.addEventListener('click', function() {
        if (audio.paused) {
          audio.play().then(() => {
            if (playIcon && pauseIcon) {
              playIcon.classList.add('hidden');
              pauseIcon.classList.remove('hidden');
            }
          }).catch(err => {
            console.log('Audio play failed:', err);
            // Fallback: show a message about autoplay restrictions
            if (songTitle) {
              songTitle.textContent = 'Click to enable music (browser restriction)';
            }
          });
        } else {
          audio.pause();
          if (playIcon && pauseIcon) {
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
          }
        }
      });
      
      // Stop button
      musicStop.addEventListener('click', function() {
        audio.pause();
        audio.currentTime = 0;
        if (playIcon && pauseIcon) {
          playIcon.classList.remove('hidden');
          pauseIcon.classList.add('hidden');
        }
        updateProgress();
      });
      
      // Volume control
      volumeControl.addEventListener('input', function() {
        const volume = Number(this.value) / 100;
        audio.volume = volume;
        if (volumeValue) {
          volumeValue.textContent = this.value + '%';
        }
      });
      
      // Update progress bar
      audio.addEventListener('timeupdate', updateProgress);
      
      // Handle audio loading
      audio.addEventListener('loadedmetadata', updateProgress);
      
      // Handle audio ending (loop will restart it)
      audio.addEventListener('ended', function() {
        currentSongIndex = (currentSongIndex + 1) % playlist.length;
        if (songTitle) {
          songTitle.textContent = playlist[currentSongIndex];
        }
        updateProgress();
      });
      
      // Initialize
      updateProgress();
      
      // Try to autoplay (may be blocked by browser)
      audio.play().then(() => {
        if (playIcon && pauseIcon) {
          playIcon.classList.add('hidden');
          pauseIcon.classList.remove('hidden');
        }
      }).catch(err => {
        // Autoplay was blocked, that's normal
        console.log('Autoplay blocked, user interaction required');
      });
    });
  </script>
</MainLayout>
